<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Notes | null Web Security Study Group</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://blog.null.community/study-group-web-security/docs/csrf/notes"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Notes | null Web Security Study Group"><meta data-react-helmet="true" name="description" content="(CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which theyâ€™re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attackerâ€™s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application."><meta data-react-helmet="true" property="og:description" content="(CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which theyâ€™re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attackerâ€™s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application."><link data-react-helmet="true" rel="shortcut icon" href="/study-group-web-security/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blog.null.community/study-group-web-security/docs/csrf/notes"><link data-react-helmet="true" rel="alternate" href="https://blog.null.community/study-group-web-security/docs/csrf/notes" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog.null.community/study-group-web-security/docs/csrf/notes" hreflang="x-default"><link rel="stylesheet" href="/study-group-web-security/assets/css/styles.f4e51aac.css">
<link rel="preload" href="/study-group-web-security/assets/js/runtime~main.176889d2.js" as="script">
<link rel="preload" href="/study-group-web-security/assets/js/main.866a597b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/study-group-web-security/"><b class="navbar__title">null Web Security Study Group</b></a><a class="navbar__item navbar__link navbar__link--active" href="/study-group-web-security/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/study-group-web-security/showcase">Showcase</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/null-open-security-community" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/study-group-web-security/docs/intro">Hey Folks!</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Access Control Issues</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Cross-Site Request Forgery</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/study-group-web-security/docs/csrf/notes">Notes</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">File Upload Vulnerabilities</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web Cache Deception Attack</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">XML External Entity</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Miscellaneous</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contributors</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contribute</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Notes</h1></header><p>(CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which theyâ€™re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attackerâ€™s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="impact">Impact<a aria-hidden="true" class="hash-link" href="#impact" title="Direct link to heading">â€‹</a></h2><p>In a successful CSRF attack, the attacker causes the victim user to carry out an action unintentionally. For example, this might be to change the email address on their account, to change their password, or to make a funds transfer. Depending on the nature of the action, the attacker might be able to gain full control over the user&#x27;s account. If the compromised user has a privileged role within the application, then the attacker might be able to take full control of all the application&#x27;s data and functionality.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="why-do-people-carry-out-csrf-attacks">Why Do People Carry Out CSRF Attacks?<a aria-hidden="true" class="hash-link" href="#why-do-people-carry-out-csrf-attacks" title="Direct link to heading">â€‹</a></h2><p>The motivations of CSRF attacks are either financially fuelled or intended to change key information within a user account or within an application or website.</p><p>For instance, in the examples of CSRF attacks that we are aware of, they have been used to carry out the below functions:</p><ul><li>Amend a user password or force a password reset</li><li>Move money from a bank account</li><li>Amend the delivery address for a purchase</li><li>Utilise a Content Management System (CMS) to remove or add content to a website</li><li>Upvote Answers, Follow or Like Social Media Accounts</li><li>Exploitation of an administrative application</li><li>Amend a content number or email on a user account</li><li>Amend a cart or shopping basket online</li><li>Alter firewall and router configuration</li></ul><p>Categorization based on OWASP 2017 - Broken Access Control: Authorization</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="typespatterns-of-csrf">Types/Patterns OF CSRF<a aria-hidden="true" class="hash-link" href="#typespatterns-of-csrf" title="Direct link to heading">â€‹</a></h2><ul><li><a href="https://medium.com/@asfiyashaikh10/cross-site-request-forgery-csrf-8ce6f9ee0379" target="_blank" rel="noopener noreferrer">https://medium.com/@asfiyashaikh10/cross-site-request-forgery-csrf-8ce6f9ee0379</a></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="samesite-attribute--paparazzi-attribute-moment">SameSite Attribute : Paparazzi Attribute moment<a aria-hidden="true" class="hash-link" href="#samesite-attribute--paparazzi-attribute-moment" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://www.kevel.co/blog/chrome-samesite/" target="_blank" rel="noopener noreferrer">https://www.kevel.co/blog/chrome-samesite/</a></li></ul><p>The SameSite attribute tells browsers when and how to fire cookies in first- or third-party situations. SameSite is used by a variety of browsers to identify whether or not to allow a cookie to be accessed.</p><ul><li><a href="https://web.dev/samesite-cookies-explained/" target="_blank" rel="noopener noreferrer">https://web.dev/samesite-cookies-explained/</a></li></ul><p>Sure thing! Values for the SameSite attribute include &#x27;strict&#x27;, &#x27;lax&#x27;, or &#x27;none&#x27;:</p><ul><li>&#x27;lax&#x27; enables only first-party cookies to be sent/accessed</li><li>&#x27;strict&#x27; is a subset of &#x27;lax&#x27; and wonâ€™t fire if the incoming link is from an external site</li><li>&#x27;none&#x27; signals that the cookie data can be shared with third parties/external sites (for advertising, embedded content, etc)</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="steps">Steps<a aria-hidden="true" class="hash-link" href="#steps" title="Direct link to heading">â€‹</a></h2><ol><li><p>CSRF occurs when an attacker make a target&#x27;s browser send an HTTP Request to another website.</p></li><li><p>Attack relies on the target being previously authenticated on the vulnerable website = Mean victim must be sign-in on target</p></li><li><p>So, the action is submitted and occurs without the target&#x27;s knowledge.</p></li></ol><p>4.If attack is successful, attacker can modify server side information and is even possible to achieve to account takeover.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="background-of-the-attack">Background of the Attack<a aria-hidden="true" class="hash-link" href="#background-of-the-attack" title="Direct link to heading">â€‹</a></h2><ul><li>CSRF attack take advantage of weakness in the process website use to Authenticate Requests.</li><li>Authentication</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="csrf-with-get-request">CSRF with GET Request<a aria-hidden="true" class="hash-link" href="#csrf-with-get-request" title="Direct link to heading">â€‹</a></h3><p>Useful Tag - <code>&lt;img&gt;</code>
Example - <code>&lt;img src=&quot;https://www.bank.com/transfer?from=victim&amp;to=attacker&amp;amount=1000&quot;&gt;</code></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="csrf-with-post-request">CSRF with POST Request<a aria-hidden="true" class="hash-link" href="#csrf-with-post-request" title="Direct link to heading">â€‹</a></h3><p>Attacker will depend on the content of POST request rather then <code>&lt;img&gt;</code> tag here, <code>&lt;iframe&gt;</code> and <code>&lt;form&gt;</code> this tag then can be beneficial.</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">csrf-poc.html</div><div class="codeBlockContent_csEI html"><pre tabindex="0" class="prism-code language-html codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag" style="color:#00009f"> </span><span class="token tag style-attr attr-name" style="color:#00a4db">style</span><span class="token tag style-attr attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag style-attr attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag style-attr attr-value style language-css property" style="color:#36acaa">display</span><span class="token tag style-attr attr-value style language-css punctuation" style="color:#393A34">:</span><span class="token tag style-attr attr-value style language-css" style="color:#e3116c">none</span><span class="token tag style-attr attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">csrf-frame</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">form</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">method</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">POST</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">action</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">http://bank.com/transfer</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">target</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">csrf-frame</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">csrf-form</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">hidden</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">from</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">Victim</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">hidden</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">to</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">Attacker</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">hidden</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">amount</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">500</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">submit</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">submit</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">form</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">getElementById</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;csrf-form&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">submit</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="pointers">Pointers<a aria-hidden="true" class="hash-link" href="#pointers" title="Direct link to heading">â€‹</a></h2><ul><li><p>When looking for CSRF vulnerabilities, look for GET request that can modify server-side data</p></li><li><p>Remember website APIâ€™s endpoints and its web pages.</p></li><li><p>Fool CORS Protection by changing the content-type header to application/x-www-form-url encoded, multipart/form-data, or text/plain.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="add-ons">Add-Ons<a aria-hidden="true" class="hash-link" href="#add-ons" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="bypasses">Bypasses<a aria-hidden="true" class="hash-link" href="#bypasses" title="Direct link to heading">â€‹</a></h3><p>There are several ways to bypass Anti-CSRF Tokens such as: </p><ol><li>Remove Anti-CSRF Token</li><li>Spoof Anti-CSRF Token by Changing a few bits </li><li>Using Same Anti-CSRF Token </li><li>Weak Cryptography to generate Anti-CSRF Token </li><li>Guessable Anti-CSRF Token </li><li>Stealing Token with other attacks such as XSS. </li><li>Converting POST Request to GET Request to bypass the CSRF Token Check.</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="resources">Resources<a aria-hidden="true" class="hash-link" href="#resources" title="Direct link to heading">â€‹</a></h2><ul><li><a href="https://www.bugbountytips.tech/category/csrf/" target="_blank" rel="noopener noreferrer">https://www.bugbountytips.tech/category/csrf/</a></li><li><a href="https://portswigger.net/web-security/csrf" target="_blank" rel="noopener noreferrer">https://portswigger.net/web-security/csrf</a></li><li><a href="https://owasp.org/www-community/attacks/csrf" target="_blank" rel="noopener noreferrer">https://owasp.org/www-community/attacks/csrf</a></li><li><a href="https://medium.com/@vbharad/2-fa-bypass-via-csrf-attack-8f2f6a6e3871" target="_blank" rel="noopener noreferrer">https://medium.com/@vbharad/2-fa-bypass-via-csrf-attack-8f2f6a6e3871</a></li><li><a href="https://medium.com/@asfiyashaikh10/cross-site-request-forgery-csrf-8ce6f9ee0379" target="_blank" rel="noopener noreferrer">https://medium.com/@asfiyashaikh10/cross-site-request-forgery-csrf-8ce6f9ee0379</a> </li><li><a href="https://vickieli.dev/csrf/csrf-updates/" target="_blank" rel="noopener noreferrer">https://vickieli.dev/csrf/csrf-updates/</a> (Detailed)</li><li><a href="https://hacktoryga.medium.com/one-click-for-victims-one-huge-leap-for-attackers-ff983eea520a" target="_blank" rel="noopener noreferrer">https://hacktoryga.medium.com/one-click-for-victims-one-huge-leap-for-attackers-ff983eea520a</a> (for demo examples).</li><li><a href="https://medium.com/bugbountywriteup/account-takeover-via-csrf-78add8c99526" target="_blank" rel="noopener noreferrer">https://medium.com/bugbountywriteup/account-takeover-via-csrf-78add8c99526</a></li><li><a href="https://techsolutions.cc/security/complete-guide-csrf-xsrf/" target="_blank" rel="noopener noreferrer">https://techsolutions.cc/security/complete-guide-csrf-xsrf/</a></li><li><a href="https://medium.com/@swapmaurya20/csrf-to-account-takeover-8d6638289f67" target="_blank" rel="noopener noreferrer">https://medium.com/@swapmaurya20/csrf-to-account-takeover-8d6638289f67</a></li><li><a href="https://medium.com/@armaanpathan/chain-the-vulnerabilities-and-take-your-report-impact-on-the-moon-csrf-to-html-injection-which-608fa6e74236" target="_blank" rel="noopener noreferrer">https://medium.com/@armaanpathan/chain-the-vulnerabilities-and-take-your-report-impact-on-the-moon-csrf-to-html-injection-which-608fa6e74236</a></li><li><a href="https://medium.com/bugbountywriteup/account-takeover-via-csrf-78add8c99526" target="_blank" rel="noopener noreferrer">https://medium.com/bugbountywriteup/account-takeover-via-csrf-78add8c99526</a></li><li><a href="https://medium.com/bugbountywriteup/lets-bypass-csrf-protection-password-confirmation-to-takeover-victim-accounts-d-4a21297847ff" target="_blank" rel="noopener noreferrer">https://medium.com/bugbountywriteup/lets-bypass-csrf-protection-password-confirmation-to-takeover-victim-accounts-d-4a21297847ff</a></li><li><a href="https://www.slideshare.net/mobile/0ang3el/neat-tricks-to-bypass-csrfprotection" target="_blank" rel="noopener noreferrer">https://www.slideshare.net/mobile/0ang3el/neat-tricks-to-bypass-csrfprotection</a></li><li><a href="https://blog.reconless.com/samesite-by-default/" target="_blank" rel="noopener noreferrer">https://blog.reconless.com/samesite-by-default/</a></li><li><a href="https://tools.ietf.org/html/draft-west-cookie-incrementalism-00" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/draft-west-cookie-incrementalism-00</a></li><li><a href="https://tipstrickshack.blogspot.com/2012/10/how-to-exploit-csfr-vulnerabilitycsrf.html" target="_blank" rel="noopener noreferrer">https://tipstrickshack.blogspot.com/2012/10/how-to-exploit-csfr-vulnerabilitycsrf.html</a></li><li><a href="https://hackerone.com/reports/127703" target="_blank" rel="noopener noreferrer">https://hackerone.com/reports/127703</a></li><li><a href="https://hackerone.com/reports/111216/" target="_blank" rel="noopener noreferrer">https://hackerone.com/reports/111216/</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="contributor">Contributor<a aria-hidden="true" class="hash-link" href="#contributor" title="Direct link to heading">â€‹</a></h2><ul><li>Simran Sankhala</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/null-open-security-community/study-group-web-security/docs/csrf/notes.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-11-06T04:36:00.000Z">11/6/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/study-group-web-security/docs/access-control/resources"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Resources</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/study-group-web-security/docs/file-upload/resources"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">File Upload Vuln - Resources<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#impact" class="table-of-contents__link toc-highlight">Impact</a></li><li><a href="#why-do-people-carry-out-csrf-attacks" class="table-of-contents__link toc-highlight">Why Do People Carry Out CSRF Attacks?</a></li><li><a href="#typespatterns-of-csrf" class="table-of-contents__link toc-highlight">Types/Patterns OF CSRF</a><ul><li><a href="#samesite-attribute--paparazzi-attribute-moment" class="table-of-contents__link toc-highlight">SameSite Attribute : Paparazzi Attribute moment</a></li></ul></li><li><a href="#steps" class="table-of-contents__link toc-highlight">Steps</a></li><li><a href="#background-of-the-attack" class="table-of-contents__link toc-highlight">Background of the Attack</a><ul><li><a href="#csrf-with-get-request" class="table-of-contents__link toc-highlight">CSRF with GET Request</a></li><li><a href="#csrf-with-post-request" class="table-of-contents__link toc-highlight">CSRF with POST Request</a></li></ul></li><li><a href="#pointers" class="table-of-contents__link toc-highlight">Pointers</a></li><li><a href="#add-ons" class="table-of-contents__link toc-highlight">Add-Ons</a><ul><li><a href="#bypasses" class="table-of-contents__link toc-highlight">Bypasses</a></li></ul></li><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li><li><a href="#contributor" class="table-of-contents__link toc-highlight">Contributor</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/study-group-web-security/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/null0x00" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/bhwDVGC9Du" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/null-the-open-security-community" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://null.community" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/null-open-security-community" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 null Web Security Study Group. Built with Docusaurus.</div></div></div></footer></div>
<script src="/study-group-web-security/assets/js/runtime~main.176889d2.js"></script>
<script src="/study-group-web-security/assets/js/main.866a597b.js"></script>
</body>
</html>